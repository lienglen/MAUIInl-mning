<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MAUIInlämning.MainPage"
             xmlns:ViewModels="clr-namespace:MAUIInlämning.ViewModels"
             xmlns:Models="clr-namespace:MAUIInlämning.Models"
             x:DataType="ViewModels:MainViewModel"
             Title="{Binding Title}">
             
    <Grid RowDefinitions="Auto, Auto, Auto, *"
          Margin="20"
          Padding="30"
          RowSpacing="20">
        <Label Grid.Row="0"
            Text="Book Search"
        FontSize="32"
        FontAttributes="Bold"
        HorizontalOptions="Center"
        TextColor="{StaticResource PrimaryDarkText}"/>
        <SearchBar Grid.Row="1"
               Placeholder="Search title, author or genre"
               Text="{Binding SearchText}"
               SearchCommand="{Binding SearchCommand}"
               />

        <Button Grid.Row="2"
                    Text="Search"
                    Command="{Binding SearchCommand}"
                ></Button>


        <CollectionView Grid.Row="3"
                            ItemsSource="{Binding Books}"
                            SelectionMode="Single"
                            SelectedItem="{Binding SelectedBook}"
                            SelectionChangedCommand="{Binding HandleNavigationCommand}"
                            SelectionChangedCommandParameter="{Binding SelectedItem, Source={RelativeSource Self}}"
                            Margin="0,10,0,0">

            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical" 
                                 Span="2" 
                                 HorizontalItemSpacing="10" 
                                 VerticalItemSpacing="10" />
            </CollectionView.ItemsLayout>

            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="Models:Book">
                    <Grid Padding="5">
                        <Border Margin="20, 15" Padding="5" StrokeShape="10" BackgroundColor="#FFFFFF">
                            <Border.Shadow>
                                <Shadow Brush="Black" Offset="5,5" Radius="10" Opacity="0.2" />
                            </Border.Shadow>

                            <VerticalStackLayout Padding="10">
                                <Image Source="{Binding ImageUrl}" WidthRequest="100" HeightRequest="150" HorizontalOptions="Start"/>
                                <Label Text="{Binding Title}" FontAttributes="Bold" FontSize="18" TextColor="Black" />
                                <Label Text="{Binding Author}" FontSize="14"/>
                                <Label Text="{Binding Description}" FontSize="12" LineBreakMode="WordWrap"/>
                            </VerticalStackLayout>

                        </Border>
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>

        </CollectionView>

    </Grid>

</ContentPage>
